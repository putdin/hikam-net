var nisn = 0 $ (document).ready(function(){ $('#loading-simpan, #loading-ubah, #loading-hapus, #pesan-error, $pesan-sukses, #btn-reset').hide() $('#view').on('click', '.btn-form-ubah', function(){ nisn = $(this).data('id_pembayaran') $('$btn-simpan').hide()
$('#btn_ubah').show() $('#modal-title').html('Form Pembayaran') var tr = $(this).closest('tr') var tglbayar = tr.find('.tglbayar-value').val() var keterangan = tr.find('.keterangan-value').val() var idpetugas = tr.find('.idpetugas-value').val() $('#tgl_bayar').val(tglbayar)
$('#keterangan').val(keterangan) $('#id_petugas').val(id_petugas) }) $('#view').on('click', '.btn-alert-hapus', function(){ nisn = $(this).data('id_pembayaran') }) $ ('#btn-tambah').click(function(){ $('#btn-ubah').hide() $('#btn-simpan').show() $('#modal-title').html('Form
Simpan') }) $('#btn-simpan').click(function(){ $('#loading-simpan').show() $.ajax({ url: base_url + 'admin/pembayaran/simpan', type: 'POST', data: $("#form-modal form").serialize(), dataType: 'json', beforeSend: function(e) { if(e && e.overrideMimeType)
{ e.overrideMimeType('application/jsoncharset=UTF-8') } }, success: function(response){ $('#loading-simpan').hide() if(response.status == 'sukses') { $('#view').html(response.html) $('#pesan-sukses').html(response.pesan).fadeIn().delay(10000).fadeOut()
$('#form-modal').modal('hide') }else{ $('#pesan-error').html(response.pesan).show() } }, error: function (xhr, ajaxOptions, thrownError) { alert(xhr.responseText) } }) }) $('#btn-ubah').click(function(){ $('#loading-ubah').show() $.ajax({ url: base_url
+ 'admin/pembayaran/edit/' + nisn, type: 'POST', data: $("#form-modal form").serialize(), dataType: 'json', beforeSend: function(e) { if(e && e.overrideMimeType) { e.overrideMimeType('application/jsoncharset=UTF-8') } }, success: function(response) {
$('#loading-ubah').hide() if(response.status == 'sukses') { $('#view').html(response.html) $('#pesan-sukses').html(response.pesan).fadeIn().delay(10000).fadeOut() $('#form-modal').modal('hide') }else{ $('#pesan-error').html(response.pesan).show() } }
}) }) $('#btn-hapus').click(function(){ $('#loading-hapus').show() $.ajax({ url: base_url + 'admin/pembayaran/hapus' + nisn, type: 'GET', dataType: 'json', beforeSend: function(e) { if(e && e.overrideMimeType) { e.overrideMimeType('application/jsoncharset=UTF-8')
} }, success: function(response){ $('#loading-hapus').hide() $('#view').html(response.html) $('#pesan-sukses').html(response.pesan).fadeIn().delay(10000).fadeOut() $('#delete-modal').modal('hide') } }) }) $('#form-modal').on('hidden.bs.modal', function
(e){ $('#form-modal input, #form-modal select, #form-modal textarea').val('') }) })